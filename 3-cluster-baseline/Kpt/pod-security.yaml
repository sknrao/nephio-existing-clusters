# Pod Security Standards for namespaces
# Kubernetes 1.23+ uses Pod Security Admission instead of PSPs

---
# Privileged mode for system namespaces (needed for CNI, storage, etc)
apiVersion: v1
kind: Namespace
metadata:
  name: kube-system
  labels:
    pod-security.kubernetes.io/enforce: privileged
    pod-security.kubernetes.io/audit: privileged
    pod-security.kubernetes.io/warn: privileged
---
apiVersion: v1
kind: Namespace
metadata:
  name: local-path-storage
  labels:
    pod-security.kubernetes.io/enforce: privileged
    pod-security.kubernetes.io/audit: privileged
    pod-security.kubernetes.io/warn: privileged
---
apiVersion: v1
kind: Namespace
metadata:
  name: config-management-system
  labels:
    pod-security.kubernetes.io/enforce: privileged
    pod-security.kubernetes.io/audit: privileged
    pod-security.kubernetes.io/warn: privileged

---
# Baseline mode for network function namespaces
# OAI and Free5GC need some elevated privileges but not fully privileged

apiVersion: v1
kind: Namespace
metadata:
  name: openairinterface
  labels:
    nephio.org/cluster-name: my-ran # kpt-set: ${cluster-name}
    nephio.org/workload-type: ran
    pod-security.kubernetes.io/enforce: baseline
    pod-security.kubernetes.io/audit: baseline
    pod-security.kubernetes.io/warn: baseline
---
apiVersion: v1
kind: Namespace
metadata:
  name: oai-ran-cucp
  labels:
    nephio.org/cluster-name: my-ran # kpt-set: ${cluster-name}
    nephio.org/workload-type: ran
    nephio.org/nf-type: cucp
    pod-security.kubernetes.io/enforce: baseline
    pod-security.kubernetes.io/audit: baseline
    pod-security.kubernetes.io/warn: baseline
---
apiVersion: v1
kind: Namespace
metadata:
  name: oai-ran-cuup
  labels:
    nephio.org/cluster-name: my-ran # kpt-set: ${cluster-name}
    nephio.org/workload-type: ran
    nephio.org/nf-type: cuup
    pod-security.kubernetes.io/enforce: baseline
    pod-security.kubernetes.io/audit: baseline
    pod-security.kubernetes.io/warn: baseline
---
apiVersion: v1
kind: Namespace
metadata:
  name: oai-ran-du
  labels:
    nephio.org/cluster-name: my-ran # kpt-set: ${cluster-name}
    nephio.org/workload-type: ran
    nephio.org/nf-type: du
    pod-security.kubernetes.io/enforce: baseline
    pod-security.kubernetes.io/audit: baseline
    pod-security.kubernetes.io/warn: baseline
---
apiVersion: v1
kind: Namespace
metadata:
  name: free5gc
  labels:
    nephio.org/cluster-name: my-core # kpt-set: ${cluster-name}
    nephio.org/workload-type: core
    pod-security.kubernetes.io/enforce: baseline
    pod-security.kubernetes.io/audit: baseline
    pod-security.kubernetes.io/warn: baseline
---
apiVersion: v1
kind: Namespace
metadata:
  name: free5gc-cp
  labels:
    nephio.org/cluster-name: my-core # kpt-set: ${cluster-name}
    nephio.org/workload-type: core
    nephio.org/plane: control
    pod-security.kubernetes.io/enforce: baseline
    pod-security.kubernetes.io/audit: baseline
    pod-security.kubernetes.io/warn: baseline
---
apiVersion: v1
kind: Namespace
metadata:
  name: free5gc-up
  labels:
    nephio.org/cluster-name: my-core # kpt-set: ${cluster-name}
    nephio.org/workload-type: core
    nephio.org/plane: user
    pod-security.kubernetes.io/enforce: baseline
    pod-security.kubernetes.io/audit: baseline
    pod-security.kubernetes.io/warn: baseline

---
# Pod Security Standards explanation:
# 
# privileged: Unrestricted, allows known privilege escalations
#   - Needed for: CNI plugins, storage provisioners, system components
#
# baseline: Minimally restrictive, prevents known privilege escalations
#   - Allowed: hostNetwork (for SCTP/secondary interfaces)
#   - Allowed: specific capabilities (NET_ADMIN, NET_RAW for 5G)
#   - Forbidden: privileged containers, hostPath, hostPID
#
# restricted: Heavily restricted, follows Pod hardening best practices
#   - Too restrictive for 5G NFs which need network capabilities